# PetsRS-Dataset
The PetsRS-Dataset is a collection of dog and cat images organized in image pairs that belong to the same individual. 
This dataset is intended to be used for evaluating instance-level identification models for pet recognition and/or 
verification. The dataset is composed of 1834 images of dogs and 616 images of cats. These pictures were extracted 
from the [PetsRS website](https://petsrs.com.br/), an application created by volunteers in the context of the 2024 floodings in the region 
surrounding the Guaiba waterbody in Rio Grande do Sul, Brazil. The application aims to reconnect pets and guardians 
that were separated because of the floods during evacuations. On one end of this application, guardians searching 
for their lost pets can submit pictures of the animal, on the other end, shelter volunteers and temporary guardians 
of rescued pets can do the same. This results in a crowd-sourced open database of lost and rescued pets. Pet recognition 
models were critical in this scenario and our dataset can evaluate how such a model would perform in this situation. 

## License and dataset access

The dataset is publicly available on Google Drive [here](https://drive.google.com/drive/folders/1ljLg3mMSA3FDYcFvf7QJnT5EHCj3yO4N). Any future versions of the dataset will be properly identified 
and uploaded as a separate folder on the same Google Drive link, preserving the version described in the paper (1.0). 
This dataset is licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0). This license allows for 
sharing and adaptation with proper attribution.

The associated code for dataset creation and benchmark with off-the-shelf models evaluation available in this repo is 
licensed under the MIT License, permitting reuse with attribution and minimal restrictions.

## Environment

To properly run this benchmark, it is highly recommended to use a docker container with our image available on dockerhub by running:

```bat
docker run --gpus all -it -v <path-to-PetsRS-Dataset-repo-clone>:/workspace/ pglpinto/pets-rs-dataset
```

Alternatively, you can setup your conda environment with the provided *requirements.txt* by running the command below inside your conda env. 

```bat
conda install --file requirements.txt
```

## Running experiments

To create embeddings for the PetsRS-Dataset using one of the pre-trained encoders tested in the paper and evaluate their recall, run the commands below, where <model-family> must be 'clip', 'dino' or 'resnet'. The resulting recall for each *K* value and subset of the PetsRS-Dataset will be outputted on the terminal. 

```bat
cd scripts/encoders/
sh run_experiment.sh <path-to-PetsRS-Datast> <path-to-output-embeddings> <model-family>
```

To run all the experiments as presented in the paper, execute:

```bat
cd scripts/encoders/
sh run_experiment.sh <path-to-PetsRS-Datast> results/dino_embeddings dino
sh run_experiment.sh <path-to-PetsRS-Datast> results/clip_embeddings clip
sh run_experiment.sh <path-to-PetsRS-Datast> results/resnet_embeddings resnet
```

You can also use the same recall evaluation script to compare a new model with this baseline. To do so, save the embeddings generated by the new model for all images in the PetsRS-Dataset as .npy files keeping the original structure of the dataset (just as the *run_endocing.py* script does for the pre-trained encoders). You can do this by adding new *preprocess_\** and *run_\** functions to the *run_endocing.py* script. Then run the following command for each *K* to be tested.

```bat
python recall_evaluation.py <path-to-generated-embeddings> <K-value>
```

## Acknowledgments

This work was part of the efforts to improve the PetsRS matching system and now can be used to evaluate future models that tackle the pet recognition problem. We would like to thank the [PetsRS team](https://petsrs.com.br/voluntarios) for creating the application that made this dataset and benchmark possible and for providing us with scripts to download the website images. We would also like to thank everyone who contributed to the crowdsourced PetsRS database. 
